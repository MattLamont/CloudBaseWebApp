<ng-sidebar-container class="app" [ngClass]="{'mode-boxed': isBoxed, 'sidebar-opened': isOpened, 'theme-light': theme == 'light', 'theme-dark': theme == 'dark', 'mode-push': _mode == 'push', 'mode-dock': _mode == 'dock', 'mode-over': _mode == 'over', 'mode-slide': _mode == 'slide', 'no-footer': options?.removeFooter, 'map-header': options?.mapHeader}">
  <ng-sidebar [(opened)]="isOpened" [(mode)]="_mode" [position]="'left'" [dockedSize]="'80px'" [autoCollapseWidth]="'991'" [closeOnClickOutside]="isOver()" [showBackdrop]="isOver()" [sidebarClass]="'sidebar-panel'" #sidebar>
    <nav class="navbar custom-navbar main-brand">
      <a class="navbar-brand mr-auto" [routerLink]="['/']">
        <img src="assets/images/logos/cloud-base-logo-white.png" class="navbar-brand-logo" alt="">
        <span class="docked-hidden">&nbsp;CloudBase</span>
      </a>
      <ul class="navbar-nav">
        <li class="nav-item">
          <a href="javascript:;" class="nav-link" (click)="toogleSidebar()">
            <i class="hamburger-icon v2" *ngIf="_mode === 'over' && !isOver()">
              <span></span>
            </i>
          </a>
        </li>
      </ul>
    </nav>
    <!-- main navigation -->
    <nav class="menu">
      <ul class="navigation" appAccordion>
        <li class="navigation-item" appAccordionLink>
          <a class="navigation-link" appAccordionToggle [routerLink]="[ '/' ]">
            <i class="icon icon-basic-accelerator"></i>
            <span>Home</span>
            <span class="mr-auto"></span>
          </a>
        </li>

        <li class="navigation-item" appAccordionLink>
          <a class="navigation-link" appAccordionToggle>
            <i class="icon icon-basic-archive-full"></i>
            <span>Categories</span>
            <span class="mr-auto"></span>
            <i class="menu-caret icon icon-arrows-right"></i>
          </a>
          <ul class="navigation-submenu">
            <li class="navigation-item" *ngFor="let category of categories" routerLinkActive="open">
              <a [routerLink]="['/categories', category.link ]" class="navigation-link relative">{{ category.name }}</a>
            </li>
          </ul>
        </li>

        <li class="navigation-item" appAccordionLink>
          <a class="navigation-link" appAccordionToggle [routerLink]="[ '/create' , 'recipe' ]">
            <i class="icon icon-basic-todo-pencil"></i>
            <span>Create Recipe</span>
            <span class="mr-auto"></span>
          </a>
        </li>

        <!--Following Tab -->
        <li class="navigation-item" *ngIf="sessionUser">
          <a class="navigation-link">
            <i class="icon-people"></i>
            <span>Following</span>
            <span class="mr-auto"></span>
            <!--<span class="badge badge-{{ badge.type }}">{{ badge.value }}</span>-->
            <!--<i class="menu-caret icon icon-arrows-right"></i>-->
          </a>
          <ul class="">
            <li class="navigation-item" *ngFor="let followed of sessionUser.following" routerLinkActive="open">
              <a class="following-link navigation-link" [routerLink]="['/profile' , followed.id ]">
                <img class="avatar-xxs rounded-circle img-fluid mr-2" src="{{followed.image_url || 'assets/images/blank_user.png'}}" onError="this.src='assets/images/blank_user.png';" />
                <span class="text-truncate">{{ followed.username }}</span>
              </a>
            </li>
          </ul>
        </li>
        <!-- end following tab -->

        <li class="navigation-item">
          <hr class="mt-0 mb-0" />
        </li>
      </ul>

    </nav>
    <!-- /main navigation -->
  </ng-sidebar>

  <div ng-sidebar-content class="app-inner">
    <nav class="navbar custom-navbar bg-faded main-header">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a href="javascript:;" class="nav-link" (click)="toogleSidebar()">
            <i class="hamburger-icon v2">
              <span></span>
            </i>
          </a>
        </li>
      </ul>
      <span class="navbar-heading hidden-xs-down">{{options?.heading}}</span>
      <span class="mr-auto"></span>

      <ul class="navbar-nav">
        <li class="nav-item" ngbDropdown placement="bottom-right" *ngIf="!sessionUser">
          <button type="button" class="btn btn-outline-primary mr-1 mb-1" [routerLink]="['/authentication/signin']">Log In</button>
        </li>

        <li class="nav-item" ngbDropdown placement="bottom-right" *ngIf="!sessionUser">
          <button type="button" class="btn btn-outline-success mr-1 mb-1" [routerLink]="['/authentication/signup']">Sign Up</button>
        </li>

        <li class="nav-item" ngbDropdown placement="bottom-right" *ngIf="sessionUser">
          <a href="javascript:;" class="nav-link" ngbDropdownToggle>
            <img src="{{sessionUser.image_url || 'assets/images/blank_user.png'}}" onError="this.src='assets/images/blank_user.png';" class="navbar-avatar rounded-circle" alt="user" title="user">
          </a>
          <div ngbDropdownMenu class="dropdown-menu dropdown-menu-right">
            <a class="dropdown-item" [routerLink]="['/settings']">
              <i class="icon icon-basic-settings mr-3"></i>
              <span>Settings</span>
            </a>
            <a class="dropdown-item" [routerLink]="['/profile/' + sessionUser.id]">
              <i class="icon icon-basic-postcard mr-3"></i>
              <span>Profile</span>
            </a>

            <!--
            <a class="dropdown-item" href="javascript:;">
              <i class="icon icon-basic-message-multiple mr-3"></i>
              <span>Notifications</span>
            </a>
            -->

            <div class="dropdown-divider"></div>
            <a class="dropdown-item" (click)="signout()">
              <i class="icon icon-arrows-switch-vertical mr-3"></i>
              <span>Signout</span>
            </a>
          </div>
        </li>

        <!--
        <li class="nav-item" ngbDropdown placement="bottom-right">
          <a href="javascript:;" class="nav-link" ngbDropdownToggle *ngIf="user">
            <i class="fi flaticon-notification"></i>
            <span class="badge badge-danger">4</span>
          </a>
          <div ngbDropdownMenu class="dropdown-menu dropdown-menu-right notifications">
            <div class="notifications-wrapper">
              <a href="javascript:;" class="dropdown-item">
                <span class="badge badge-warning">NEW</span>
                &nbsp;Sean launched a new application
                <span class="time">2 seconds ago</span>
              </a>
              <a href="javascript:;" class="dropdown-item">
                Removed calendar from app list
                <span class="time">4 hours ago</span>
              </a>
              <a href="javascript:;" class="dropdown-item">
                Jack Hunt has joined mailing list
                <span class="time">9 days ago</span>
              </a>
              <a href="javascript:;" class="dropdown-item">
                <span class="text-muted">Conan Johns created a new list</span>
                <span class="time">9 days ago</span>
              </a>
            </div>
            <div class="notification-footer">Notifications</div>
          </div>
        </li>
        -->

        <li class="nav-item">
          <a href="javascript:;" class="nav-link" appToggleFullscreen>
            <i class="fi flaticon-fullscreen"></i>
          </a>
        </li>

        <li class="nav-item">
          <span class="nav-divider"></span>
        </li>
        <li class="nav-item">
          <a href="javascript:;" class="nav-link" (click)="openSearch(search)">
            <i class="fi flaticon-search"></i>
          </a>
        </li>

      </ul>
    </nav>

    <div class="main-content">
      <router-outlet></router-outlet>

      <!--
      <nav class="navbar custom-navbar navbar-light main-footer small">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="javascript:;">
              <span>Copyright &copy; 2017</span> <span class="ff-headers text-uppercase">Decima</span>. All rights reserved
            </a>
          </li>
        </ul>
        <ul class="navbar-nav hidden-xs-down">
          <li class="nav-item">
            <a class="nav-link" href="javascript:;">Made with love on Earth</a>
          </li>
        </ul>
      </nav>
    -->

    </div>
  </div>

</ng-sidebar-container>

<ng-template #search let-c="close" let-d="dismiss">
  <form class="search__form" action="">
    <input class="search-input" name="search" type="search" placeholder="Search..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" autofocus="true" (input)="onSearchChange($event.target.value)" />
    <p class="text-muted"><small><strong>Hit enter to search or ESC to close</strong></small></p>
  </form>
  <!--
  <div class="search-suggestions">
    <h6 class="text-uppercase"><strong>Suggestions?</strong></h6>
    <p class="text-primary">#medical #analytics #fitness #transport #ui #dashboard #admin #bootstrap #angular #typescript</p>
  </div>
  -->
  <h5 class="ff-headers mt-2" *ngIf="searchRecipeItems.length > 0">Recipes [{{searchRecipeItems.length}}<span *ngIf="searchRecipeItems.length == 20">+</span>]</h5>
  <div>
    <a *ngFor="let item of searchRecipeItems" [routerLink]="[ '/recipe' , item.id]" class="mt-3" (click)="d('Cross click')">
      <h6>{{item.name}}</h6>
    </a>
  </div>
  <h5 class="ff-headers mt-2" *ngIf="searchUserItems.length > 0">Users [{{searchUserItems.length}}<span *ngIf="searchUserItems.length == 20">+</span>]</h5>
  <div>
    <a *ngFor="let item of searchUserItems" [routerLink]="[ '/profile' , item.id]" class="mt-3" (click)="d('Cross click')">
      <h6>{{item.username}}</h6>
    </a>
  </div>
  <h5 class="ff-headers mt-2" *ngIf="searchFlavorItems.length > 0">Flavors [{{searchFlavorItems.length}}<span *ngIf="searchFlavorItems.length == 20">+</span>]</h5>
  <div>
    <a *ngFor="let item of searchFlavorItems" href="{{item.link}}" class="mt-3" (click)="d('Cross click')">
      <h6>{{item.name}}</h6>
    </a>
  </div>
  <button type="button" class="search-close" aria-label="Close search form" (click)="d('Cross click')">
    <i class="fi flaticon-close"></i>
  </button>
</ng-template>
